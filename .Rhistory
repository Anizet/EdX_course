library(tidyverse)
library(dplyr)
library(readr)
library(tidyverse)
library(readr)
ability <- sample(0:100, size = 10000, replace = TRUE)
chance <- sample(0:100, size = 10000, replace = TRUE)
total <- data.frame(ability = ability, chance = chance)
library(tidyverse)
library(dplyr)
total <- total %>% mutate(chance = chance*5/100) %>% mutate(ability = ability*95/100) %>% mutate(sum = ability + chance)
top_n(total, 10, sum) %>% summarize(ma = mean(ability), mc = mean(chance))
top_n(total, 10, sum) %>% summarize(ma = mean(ability), mc = mean(chance))
top_n(total, 10, sum) %>% summarize(ma = mean(ability), mc = mean(chance))
url <- "https://en.wikipedia.org/wiki/Murder_in_the_United_States_by_state"
library(tidyverse)
library(rvest)
url <- "https://en.wikipedia.org/wiki/Murder_in_the_United_States_by_state"
h <- read_html(url) # allows to read the object in the url
taby <- h %>% html_nodes(".headerSort , td") %>% html_table()
taby <- h %>% html_nodes("td") %>% html_table()
tab <- h %>% html_nodes("table")
?pull
?Teams
library(Lahman)
?Teams
library(Lahman)
?Teams
library(Lahman)
?Teams
??Teams
str(Teams)
data(Teams)
data(Lahman)
library(Lahman)
install.packages("Lahman")
library(tidyverse)
(dplyr)
library(dplyr)
library(Lahman)
data("Teams")
str(Teams)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
ggplot(aes(R_per_game, AB_per_game)) +
geom_point(alpha = 0.5)
View(plott)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
ggplot(aes(R_per_game, AB_per_game)) +
geom_point(alpha = 0.5)
library(tidyverse)
library(dplyr)
library(Lahman)
library(ggplot2)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
ggplot(aes(R_per_game, AB_per_game)) +
geom_point(alpha = 0.5)
data("Teams")
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
ggplot(aes(R_per_game, AB_per_game)) +
geom_point(alpha = 0.5)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G)
plottt <- plott %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point(alpha = 0.5)
View(plottt)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
select(AB_per_game, R_per_game)
plottt <- plott %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point(alpha = 0.5)
View(plottt)
library(tidyverse)
library(dplyr)
library(Lahman)
library(dplyr)
library(Lahman)
library(ggplot2)
data("Teams")
force(Teams)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
select(AB_per_game, R_per_game) %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point(alpha = 0.5)
View(plott)
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
select(AB_per_game, R_per_game) %>% ggplot(aes(R_per_game, AB_per_game)) + geom_line
plott <- Teams %>% filter(yearID %in% 1961:2001) %>%
mutate(AB_per_game = AB/G, R_per_game = R/G) %>%
select(AB_per_game, R_per_game) %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point()
a = c(10,11,25,20,16)
b = c(4,8,9,4,2)
c = [a,b]
c = tibble(a = a, b = b)
View(c)
c %>% ggplot(aes(b, a)) %>% geom_point()
c %>% ggplot(aes(b, a)) + geom_point()
plott <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% select(AB_per_game, R_per_game) %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point()
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% select(AB_per_game, R_per_game) %>% ggplot(aes(R_per_game, AB_per_game)) + geom_point()
str(Teams)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) %>% geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5) + geom_jitter(
)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5) + geom_jitter() )
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5) + geom_jitter()
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5) + geom_jitter(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, fieldingE_per_game = E/G) %>%
ggplot(aes(fieldingE_per_game, W_per_game)) + geom_point(alpha = 0.5)
Teams %>% filter(yearID %in% 1961:2001) %>% mutate(triples_per_game = X3B/G, doubles_per_game = X2B/G) %>% ggplot(aes(doubles_per_game, triples_per_game)) + geom_point(alpha = 0.5)
yo <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G)
yo <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% cor(AB_per_game, R_per_game)
yo <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% cor(AB_per_game, R_per_game)
yo <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% summarize(cor(AB_per_game, R_per_game))
View(yo)
yo
yo <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(AB_per_game = AB/G, R_per_game = R/G) %>% summarize(r = cor(AB_per_game, R_per_game))
yo
yop <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(W_per_game = W/G, E_per_game = E/G) %>% summarize(r = cor(W_per_game, E_per_game))
yop
yopi <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(X2B_per_game = X2B/G, X3B_per_game = X3B/G) %>% summarize(r = cor(X2B_per_game, X3B_per_game))
yopi
sqrt(1-(0.5^2))
set.seed(1989) #if you are using R 3.5 or earlier
library(HistData)
install.packages("HistData")
library(HistData)
data("GaltonFamilies")
female_heights <- GaltonFamilies%>%
filter(gender == "female") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(mother, childHeight) %>%
rename(daughter = childHeight)
str(female_heights)
mean(female_heights$mother)
mean(female_heights$daughter)
cor(female_heights$mother, female_heights$daughter)
mean(female_heights$mother)
sd(female_heights$mother)
mean(female_heights$daughter)
sd(female_heights$mother)
cor(female_heights$mother, female_heights$daughter)
sd(female_heights$daugther)
sd(female_heights$daughter)
(d/b)*e
a <- mean(female_heights$mother)
b <- sd(female_heights$mother)
c <-mean(female_heights$daughter)
d <- sd(female_heights$daughter)
e <- cor(female_heights$mother, female_heights$daughter)
(d/b)*e
(b/d)*e
c - (d/b)*e*a
e^2
60*(d/b)*e + 42.52
library(Lahman)
library(Lahman)
data("Teams")
library(tidyverse)
Teams <- Teams %>% filter(yearID %in% 1961:2001)
?lm
str(Teams)
Teams <- Teams %>% filter(yearID %in% 1961:2001) %>% mutate(R_pg = R/G, BB_pg = BB/G, HR_pg = HR/G)
str(Teams)
fit <- lm(R_pg ~ BB_pg HR_pg, data = Teams)
fit <- lm(R_pg ~ BB_pg + HR_pg, data = Teams)
summary(fit)
set.seed(1983)
galton_heights <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
library(HistData)
data("GaltonFamilies")
set.seed(1983)
galton_heights <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
B <- 1000
N <- 100
lse <- replicate(B, {
sample_n(galton_heights, N, replace = TRUE) %>%
lm(son ~ father, data = .) %>% .$coef
})
lse <- data.frame(beta_0 = lse[1,], beta_1 = lse[2,])
fit <- lm(R_pg ~ BB_pg + HR_pg, data = Teams)
fit %>% ggplot(aes(R_pg, BB_pg, HR_pg)) + geom_smooth(method = "lm")
fit %>% ggplot(aes(R_pg, BB_pg)) + geom_smooth(method = "lm")
fit %>% ggplot(aes(BB_pg, R_pg)) + geom_smooth(method = "lm")
fit %>% ggplot(aes(BB_pg, R_pg)) + geom_smooth(method = "lm") + geom_point()
beta1 = seq(0, 1, len=nrow(galton_heights))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), col=2)
library(HistData)
data("GaltonFamilies")
set.seed(1983)
galton_heights <- GaltonFamilies %>%
filter(gender == "male") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(father, childHeight) %>%
rename(son = childHeight)
beta1 = seq(0, 1, len=nrow(galton_heights))
results <- data.frame(beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), col=2)
rss <- function(beta0, beta1, data){
resid <- galton_heights$son - (beta0+beta1*galton_heights$father)
return(sum(resid^2))
}
beta1 = seq(0, 1, len=nrow(galton_heights))
results <- data.frame(beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 25))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), col=2)
beta1 = seq(0, 1, len=nrow(galton_heights))
results <- data.frame(beta1 = beta1,
rss = sapply(beta1, rss, beta0 = 36))
results %>% ggplot(aes(beta1, rss)) + geom_line() +
geom_line(aes(beta1, rss), col=2)
set.seed(1989) #if you are using R 3.5 or earlier
library(HistData)
data("GaltonFamilies")
options(digits = 3)    # report 3 significant digits
female_heights <- GaltonFamilies %>%
filter(gender == "female") %>%
group_by(family) %>%
sample_n(1) %>%
ungroup() %>%
select(mother, childHeight) %>%
rename(daughter = childHeight)
lm(mother ~ daughter, data = female_heights)
xi <- lm(mother ~ daughter, data = female_heights)
summary(xi)
female_heights$mother[1]
44.18 + 0.3103*female_heights$daughter[1]
library(Lahman)
bat_02 <- Batting %>% filter(yearID == 2002) %>%
mutate(pa = AB + BB, singles = (H - X2B - X3B - HR)/pa, bb = BB/pa) %>%
filter(pa >= 100) %>%
select(playerID, singles, bb)
